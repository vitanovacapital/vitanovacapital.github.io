define("render",["lodash","utils","core","reactDOM"],function(a,b,c,d){"use strict";function f(a){var c=a.fullFunctionality.getConfig(),d=b.urlUtils.parseUrlParams(window.location.search.replace(/^\??/,""));if(!d.dsOrigin)throw new Error("You must define dsOrigin parameter in order to use the documentServices - please speak to html-server team for a key");var e=d.configName;return e&&a[e]&&(c=a[e].getConfig()),c.origin=d.dsOrigin,c}function g(c,d){var e=a(d).keys().pull("masterPage").value();return a.mapValues(d,function(d,f){var g=a.get(window,"sssr.serverSideRender");return g&&window.pagesData&&window.pagesData[f]?d:b.dataFixer.fix(d,e.slice(),c.requestModel,c.currentUrl,c.urlFormatModel)})}function h(b,f,g,h,i){c.renderer.renderSite(f,g,h,function(c){if(window.rendered)window.rendered.forceUpdate();else{var f=document.getElementById("SITE_CONTAINER").children[0];window.rendered=d.render(c,document.getElementById("SITE_CONTAINER"));var g=document.getElementById("SITE_CONTAINER").children[0];window.sssr&&(window.sssr.success=f===g,window.sssr.clientSideRender={sinceInitialTimestamp:Date.now()-window.wixBiSession.initialTimestamp,performanceNow:e()}),window.onpopstate=window.rendered.onPopState,window.onhashchange=window.rendered.onHashChange,window.parent&&window.rendered.registerAspectToEvent("siteReady",function(){window.documentServices&&i&&i(window.rendered),window.parent.postMessage("documentServicesLoaded","*")}),b.qaAutomation&&(a.set(window,"testApi.domSelectors",b.qaAutomation.getDomSelectors(b.react,b.reactDOM)),window.testApi.domSelectors.setSearchRoot(window.rendered),a.set(window,"testApi.isReady",!0))}})}function i(d,e,i,j,k){var l=d.documentServices,m={};b.urlUtils.isQueryParamOn(i.currentUrl,"isSantaEditor")&&(m=a.assign(m,{componentViewMode:"editor"})),b.urlUtils.isQueryParamOn(i.currentUrl,"isExternalPreview")&&(m=a.assign(m,{isSocialInteractionAllowed:!1})),i.renderFlags=a.assign({},i.renderFlags,m);var n=new b.SiteData(i);try{l&&a.isUndefined(window.karmaIntegration)&&window.parent.FS&&b.integrations.fullStory.start()}catch(o){}var p=c.SiteDataAPI.createSiteDataAPIAndDal(n,e),q=p.siteData,r=p.siteDataAPI,s={pointers:p.pointers,displayedDAL:p.displayedDal,siteDataAPI:r};l?(p.dataLoadedRegistrar=r.registerDataLoadedCallback.bind(r),window.documentServices=new l.Site(f(l.configs),p,a.partial(g,i),a.partial(h,d,q,s,j)),a.set(window,"testApi.documentServices",window.documentServices)):(n.pagesData=n.pagesData&&g(i,n.pagesData),h(d,q,s,j,k))}var e=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date);return{clientSide:i}});