define("wPhoto",["lodash","react","core","santaProps","utils","image","zoomedImage","imageClientApi"],function(a,b,c,d,e,f,g,h){"use strict";function m(a,b){return b&&("goToLink"===a||!a)||"zoomMode"===a}function n(c,d,e,f,g,h,i,j,k){var l={style:{}};return l.style.width=g.width,l.style.height=g.height,m(f,e)&&(l.style.cursor="pointer"),"zoomMode"===f?a.assign(l,j(k,h,c,null,d)):!e||"goToLink"!==f&&f?l.parentConst=b.DOM.div:a.assign(l,i(e,k,h)),l}function o(a,b){return this.createChildComponent(this.props.compData,a,"img",b)}function p(a,b){return{id:a.id+"img",ref:"img",containerWidth:b.width,containerHeight:b.height,displayMode:l[a.compProp.displayMode]||a.compProp.displayMode,effectName:a.compProp.effectName,imageData:a.compData,usePreloader:a.usePreloader!==!1,addItemProp:a.addItemProp}}function q(b,c,d){var e;return this.state.isInZoom?(b.className=this.classSet({zoomedin:!0}),b.initialClickPosition=this.state.initialClickPosition,e=o.call(this,"core.components.ZoomedImage",b),c.onMouseLeave=u.bind(this),c.onMouseEnter=v.bind(this)):(b.className=this.classSet({zoomedout:!0}),e=o.call(this,"core.components.Image",b),c.onMouseLeave=a.noop,c.onMouseEnter=a.noop),a.assign(d,c),e}function r(a,b,c,d){var e=p(this.props,a),f={onClick:t.bind(this)};return!c||w(b,a)?o.call(this,"core.components.Image",e):q.call(this,e,f,d)}function s(b,c,d,e){var f={style:a.cloneDeep(b)};return f.style.width=c.width,f.style.height=c.height,f["data-exact-height"]=c.exactHeight,f["data-content-padding-horizontal"]=d.contentPaddingHorizontal,f["data-content-padding-vertical"]=d.contentPaddingVertical,f.title=e,f}function t(a){var b=this,c=this.state.isInZoom;c?this.refs.img.zoomOut(function(){b.setState({isInZoom:!c})}):this.setState({isInZoom:!c,initialClickPosition:{clientX:a.clientX,clientY:a.clientY}});var d=this.props.compProp.effectName&&"none"!==this.props.compProp.effectName;d&&this.registerReLayout()}function u(a){var b=this;v.call(this),this.zoomTimer=setTimeout(function(){t.apply(b,[a])},k)}function v(){clearTimeout(this.zoomTimer)}function w(a,b){return a.width<b.width||a.height<b.height}function x(a,b){var c={},d=parseInt(a.contentPaddingLeft.value||0,10)+parseInt(b.contentPaddingLeft||0,10),e=parseInt(a.contentPaddingRight.value||0,10)+parseInt(b.contentPaddingRight||0,10),f=parseInt(a.contentPaddingTop.value||0,10)+parseInt(b.contentPaddingTop||0,10),g=parseInt(a.contentPaddingBottom.value||0,10)+parseInt(b.contentPaddingBottom||0,10);return c.contentPaddingHorizontal=d+e,c.contentPaddingVertical=f+g,c}function y(a,b){var c=a.width-b.contentPaddingHorizontal,d=a.height-b.contentPaddingVertical;return{width:c>0?c:16,height:d>0?d:16}}function z(a,b){return{width:a.width+b.contentPaddingHorizontal,height:a.height+b.contentPaddingVertical,exactHeight:(a.exactHeight||a.height)+b.contentPaddingVertical}}var i=e.linkRenderer,j=c.compMixins,k=1200,l={fitWidthStrict:h.fittingTypes.LEGACY_FIT_WIDTH,fitHeightStrict:h.fittingTypes.LEGACY_FIT_HEIGHT};return{displayName:"WPhoto",propTypes:a.assign({id:d.Types.Component.id,compData:d.Types.Component.compData.isRequired,compProp:d.Types.Component.compProp.isRequired,structure:d.Types.Component.structure,linkRenderInfo:d.Types.Link.linkRenderInfo.isRequired,rootNavigationInfo:d.Types.Component.rootNavigationInfo.isRequired},d.santaTypesUtils.getSantaTypesByDefinition(f),d.santaTypesUtils.getSantaTypesByDefinition(g)),statics:{useSantaTypes:!0},mixins:[j.skinBasedComp,j.skinInfo,j.animationsMixin],getInitialState:function(){return this.zoomTimer=null,{isInZoom:!1}},getSkinProperties:function(){var b=this.props.structure.propertyQuery,c=this.props.compData.link||null,d=this.props.compProp.onClickBehavior,f=this.props.compProp.displayMode,g=a.pick(this.props.style,["width","height"]),h={width:this.props.compData.width,height:this.props.compData.height},j=x(this.getParams(["contentPaddingLeft","contentPaddingRight","contentPaddingBottom","contentPaddingTop"]),this.getSkinExports()),k=e.imageUtils.getContainerSize(y(g,j),h,l[f]||f),m=z(k,j),o=s(this.props.style,m,j,this.props.compData.title),p=r.call(this,k,h,"zoomAndPanMode"===d,o),q=n(this.props.compData,b,c,d,k,this.props.rootNavigationInfo,i.renderLink,i.renderImageZoomLink,this.props.linkRenderInfo);return{"":o,img:p,link:q}},getDefaultSkinName:function(){return"wysiwyg.viewer.skins.photo.DefaultPhoto"}}});